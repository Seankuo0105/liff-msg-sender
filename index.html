<body>
  <h1 style="display: none;">山豬實行</h1>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
  <script>
    async function start() {
      await liff.init({ liffId: "你的 LIFF ID" });
      if (!liff.isLoggedIn()) liff.login();

      const urlParams = new URLSearchParams(window.location.search);
      const encrypted = urlParams.get("msg");
      if (!encrypted) return;

      // 使用密碼 boar 解密
      const decrypted = CryptoJS.AES.decrypt(encrypted, "boar").toString(CryptoJS.enc.Utf8);

      // 傳送純文字訊息
      await liff.sendMessages([{ type: "text", text: decrypted }]);

      // 自動關閉
      liff.closeWindow();
    }
    start();
  </script>
</body>
