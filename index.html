<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LIFF å‚³è¨Šæ¯</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h2>ğŸ” LIFF è¨Šæ¯å‚³é€å™¨</h2>
  <p id="messageArea">æ­£åœ¨è§£æè¨Šæ¯ä¸­...</p>
  <button id="sendBtn" disabled>ğŸ“¤ å‚³é€è¨Šæ¯çµ¦è‡ªå·±</button>

  <script>
    const liffId = "2007811704-WalDOlAy"; // ä½ çš„ LIFF ID
    const params = new URLSearchParams(window.location.search);
    const rawMsg = params.get("msg");
    const decodedMsg = rawMsg ? decodeURIComponent(rawMsg) : null;

    const msgArea = document.getElementById("messageArea");
    const sendBtn = document.getElementById("sendBtn");

    if (!decodedMsg) {
      msgArea.innerText = "â—ï¸ç„¡æ•ˆçš„ç¶²å€åƒæ•¸ï¼Œè«‹ä½¿ç”¨ ?msg=ç·¨ç¢¼è¨Šæ¯";
    } else {
      msgArea.innerText = `ğŸ“¨ å°‡å‚³é€å…§å®¹ï¼šã€Œ${decodedMsg}ã€`;
      sendBtn.disabled = false;
    }

    liff.init({ liffId }).then(() => {
      if (!liff.isLoggedIn()) liff.login();
    });

    sendBtn.onclick = async () => {
      if (!liff.isInClient()) {
        alert("âš ï¸ è«‹åœ¨ LINE ä¸­é–‹å•Ÿæ­¤é é¢");
        return;
      }

      try {
        await liff.sendMessages([{ type: "text", text: decodedMsg }]);
        alert("âœ… è¨Šæ¯å·²å‚³é€ï¼");
      } catch (e) {
        console.error(e);
        alert("âŒ å‚³é€å¤±æ•—");
      }
    };
  </script>
</body>
</html>
